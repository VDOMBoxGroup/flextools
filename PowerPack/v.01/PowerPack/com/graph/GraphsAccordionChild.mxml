<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" 
		label="{langXML.navigatorpanel.graphs.title}"
		width="100%" height="100%">

	<mx:XML id="langXML"></mx:XML>
	<mx:XML id="templateXML"></mx:XML>

	<mx:Script>
		<![CDATA[
			import PowerPack.com.parse.NodeParser;
			import mx.events.ListEventReason;
			import mx.collections.ArrayCollection;
			import mx.events.ListEvent;
			
			[Bindable]
			public var graphs:ArrayCollection = new ArrayCollection();	
            
            private function beginEdit(event:ListEvent):void 
            { 
            	event.preventDefault();
            	lstGraphs.createItemEditor(0, List(event.currentTarget).selectedIndex); 
            	
				GraphThumb(event.currentTarget.itemEditorInstance).lblThumb.visible = false;            	
				GraphThumb(event.currentTarget.itemEditorInstance).txtThumb.visible = true;
				GraphThumb(event.currentTarget.itemEditorInstance).txtThumb.setFocus();
				GraphThumb(event.currentTarget.itemEditorInstance).data = 
					List(event.currentTarget).selectedItem;
				GraphThumb(event.currentTarget.itemEditorInstance).txtThumb.setSelection(0, 
					GraphThumb(event.currentTarget.itemEditorInstance).txtThumb.text.length);

                if(NodeParser.SubgraphNodeParse(GraphThumb(event.currentTarget.itemEditorInstance).txtThumb.text).result==false)
                {	                
                	GraphThumb(event.currentTarget.itemEditorInstance).txtThumb.errorString =
	                	"Enter a valid graph name.";
                }
           	}
            
            private function endEdit(event:ListEvent):void 
            {    
                event.preventDefault();	

                var newData:String = 
                    GraphThumb(event.currentTarget.itemEditorInstance).txtThumb.text;
                
                if (event.reason == ListEventReason.CANCELLED)
                {
                    // Do not update item.
	                // Close the cell editor.
	                lstGraphs.destroyItemEditor();
                	return;
                }
            	
            	// Disable copying data back to the control.
                if(NodeParser.SubgraphNodeParse(newData).result==false)
                {	      
	               	//lstGraphs.editedItemPosition = lstGraphs.editedItemPosition;
            	}            	
            	else
				{				
	                // Get new label from editor.
	                lstGraphs.editedItemRenderer.data.name =
						newData;
	
	                // Close the cell editor.
	                lstGraphs.destroyItemEditor();
	                    
	                // Notify the list control to update its display.
	        		lstGraphs.dataProvider.notifyItemUpdate(lstGraphs.editedItemRenderer);
	        		
	        		var evnt:ListEvent = new ListEvent(
	        			"completeEdit", 
	        			event.bubbles, 
	        			event.cancelable, 
	        			event.columnIndex,
	        			event.rowIndex,
	        			null,
	        			event.itemRenderer);
	        		
	        		lstGraphs.dispatchEvent(evnt);
	   			}
            }

            private function BeginningEdit(event:ListEvent):void 
            {
            	event.preventDefault();
            }               
		]]>
	</mx:Script>
			
	<mx:List width="100%" height="100%" allowMultipleSelection="false" textAlign="center" borderStyle="none"
		id="lstGraphs" 
		dataProvider="{graphs}"
		labelField="name"
		dragEnabled="true"
		alternatingItemColors="[#FFFFFF, #f6f6f6]"
		doubleClickEnabled="true"
		itemRenderer="PowerPack.com.graph.GraphThumb"
		itemEditor="PowerPack.com.graph.GraphThumb"
		editorDataField="returnText"
		itemEditBeginning="BeginningEdit(event);"
		itemEditBegin="beginEdit(event);"
		itemEditEnd="endEdit(event);"></mx:List>

</mx:VBox>
