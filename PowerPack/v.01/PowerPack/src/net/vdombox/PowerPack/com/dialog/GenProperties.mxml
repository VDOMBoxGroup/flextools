<?xml version="1.0" encoding="utf-8"?>
<GenModalDialog 
	xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns="net.vdombox.powerpack.com.dialog.*"
	xmlns:control="net.vdombox.powerpack.com.control.*"
	xmlns:controls="ExtendedAPI.com.controls.*" 
	title="{LanguageManager.sentences.properties}"
	width="450" height="240" 
	creationComplete="onShow()">
	
	<mx:Script>
		<![CDATA[
		import mx.events.CloseEvent;

		import ExtendedAPI.com.utils.FileUtils;

		import mx.utils.StringUtil;

		import net.vdombox.powerpack.com.managers.ContextManager;
		import net.vdombox.powerpack.com.managers.LanguageManager;

		private static var _dialog : GenProperties;

		static public function show( closeHandler : Function = null ) : GenProperties {
			if ( !_dialog || _dialog.closed ) {
				_dialog = new GenProperties();
				_dialog.open();
				_dialog.addEventListener( CloseEvent.CLOSE, _dialog.onClose );
				_dialog.show( OK | CANCEL, closeHandler, null, OK );

				var defaultCaptions : Object = {
					save_to_server: "Save to server",
					save_to_file: "Save to file",
					hlp_save_to_server: "Save generated application xml to server",
					hlp_save_to_file: "Save generated application xml to file",
					hlp_app_file: "Select file for saving application xml"
				};

				LanguageManager.setSentences( defaultCaptions );
			}
			else {
				_dialog.activate();
			}

			return _dialog;
		}

		private function onClose( event : Event ) : void {
			if ( event is CloseEvent && CloseEvent( event ).detail == ModalDialog.OK ) {
				ContextManager.instance.saveToServer = chkServer.selected;
				ContextManager.instance.saveToFile = chkFile.selected;
				ContextManager.instance.file.url = FileUtils.pathToUrl( fileBrowse.text );
			}
		}

		private function onShow() : void {
			fileBrowse.text = ContextManager.instance.file.nativePath;
			chkServer.setFocus();
		}
		]]>
	</mx:Script>
	
	<mx:VBox styleName="dlgHeader" width="100%">
		<mx:Label text="{LanguageManager.sentences.properties}" styleName="headerLabel"/>
	</mx:VBox>
	
	<mx:HRule width="100%"/>
		
	<mx:VBox styleName="dlgContent" height="100%">
		<mx:Grid>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="100%" height="100%" colSpan="2">
					<mx:CheckBox id="chkServer" selected="{ContextManager.instance.saveToServer}" 
						label="{LanguageManager.sentences.save_to_server}"/>
					<control:HelpTip toolTip="{LanguageManager.sentences.hlp_save_to_server}"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="100%" height="100%" colSpan="2">
					<mx:CheckBox id="chkFile" selected="{ContextManager.instance.saveToFile}" 
						label="{LanguageManager.sentences.save_to_file}"/>
					<control:HelpTip toolTip="{LanguageManager.sentences.hlp_save_to_file}"/>
				</mx:GridItem>
			</mx:GridRow>
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="100%" height="100%">
					<mx:Label text="{LanguageManager.sentences.file}:"/>
				</mx:GridItem>
				<mx:GridItem width="100%" height="100%">
					<controls:FileBrowseBox id="fileBrowse" width="300" mode="save" 
						browseLabel="{LanguageManager.sentences.browse}..." 
						browseTitle="{LanguageManager.sentences.save_file}..."
						filterAll="{LanguageManager.sentences.all}">
					</controls:FileBrowseBox>
					<control:HelpTip toolTip="{LanguageManager.sentences.hlp_app_file}"/>
				</mx:GridItem>
			</mx:GridRow>
		</mx:Grid>
	</mx:VBox>	

	<mx:HRule width="100%"/>
	
	<mx:ControlBar width="100%" styleName="dlgFooter">
	</mx:ControlBar>
	
</GenModalDialog>
