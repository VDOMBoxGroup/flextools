<?xml version="1.0" encoding="utf-8"?>
<GenModalDialog 
	xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns="net.vdombox.powerpack.dialog.*"
	xmlns:control="net.vdombox.powerpack.control.*"
	xmlns:controls="net.vdombox.powerpack.lib.extendedapi.controls.*" 
	title="{LanguageManager.sentences.connection}"
	width="450" height="300"
	creationComplete="onShow()">
	
	<mx:Script>
		<![CDATA[
		import mx.events.FlexEvent;
		import mx.events.CloseEvent;
		import mx.utils.StringUtil;

		import net.vdombox.powerpack.managers.ContextManager;
		import net.vdombox.powerpack.managers.LanguageManager;

		private static var _dialog : GenConnection;

		static public function show( closeHandler : Function = null ) : GenConnection {
			if ( !_dialog || _dialog.closed ) {
				_dialog = new GenConnection();
				_dialog.open();
				_dialog.addEventListener( CloseEvent.CLOSE, _dialog.onClose );
				_dialog.show( OK | CANCEL, closeHandler, null, OK );

				var defaultCaptions : Object = {
					hlp_host: "Host...",
					hlp_port: "Port...",
					hlp_login: "Login...",
					hlp_password: "Password..."
				};

				LanguageManager.setSentences( defaultCaptions );
			}
			else {
				_dialog.activate();
			}

			return _dialog;
		}

		private function onClose( event : Event ) : void {
			if ( event is CloseEvent && CloseEvent( event ).detail == ModalDialog.OK ) {
				ContextManager.instance.host = StringUtil.trim( txtHost.text );
				ContextManager.instance.port = StringUtil.trim( txtPort.text )
				ContextManager.instance.login = StringUtil.trim( txtLogin.text );
				ContextManager.instance.pass = StringUtil.trim( txtPass.text )
			}
		}

		private function onShow() : void {
			txtHost.setFocus();
		}
		]]>
	</mx:Script>

	<mx:VBox styleName="dlgHeader" width="100%">
		<mx:Label text="{LanguageManager.sentences.connection}" styleName="headerLabel"/>
	</mx:VBox>
	
	<mx:HRule width="100%"/>
		
	<mx:VBox styleName="dlgContent" height="100%">
		<mx:Grid>
		
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="100%" height="100%">
					<mx:Label text="{LanguageManager.sentences.host}:"/>
				</mx:GridItem>
				<mx:GridItem width="100%" height="100%">
					<mx:TextInput id="txtHost" text="{ContextManager.instance.host}" width="300"/>
					<control:HelpTip 
						toolTip="{LanguageManager.sentences.hlp_host}"/>
				</mx:GridItem>
			</mx:GridRow>
			
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="100%" height="100%">
					<mx:Label text="{LanguageManager.sentences.port}:"/>
				</mx:GridItem>
				<mx:GridItem width="100%" height="100%">
					<mx:TextInput id="txtPort" text="{ContextManager.instance.port}" restrict="0-9" width="50"/>
					<control:HelpTip
						toolTip="{LanguageManager.sentences.hlp_port}"/>
				</mx:GridItem>
			</mx:GridRow>
						
			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="100%" height="100%">
					<mx:Label text="{LanguageManager.sentences.login}:"/>
				</mx:GridItem>
				<mx:GridItem width="100%" height="100%">
					<mx:TextInput id="txtLogin" text="{ContextManager.instance.login}" width="300"/>
					<control:HelpTip
						toolTip="{LanguageManager.sentences.hlp_login}"/>
				</mx:GridItem>
			</mx:GridRow>

			<mx:GridRow width="100%" height="100%">
				<mx:GridItem width="100%" height="100%">
					<mx:Label text="{LanguageManager.sentences.password}:"/>
				</mx:GridItem>
				<mx:GridItem width="100%" height="100%">
					<mx:TextInput id="txtPass" text="{ContextManager.instance.pass}" displayAsPassword="true" width="300"/>
					<control:HelpTip
						toolTip="{LanguageManager.sentences.hlp_password}"/>
				</mx:GridItem>
			</mx:GridRow>
			
		</mx:Grid>
	</mx:VBox>	

	<mx:HRule width="100%"/>
	
	<mx:ControlBar width="100%" styleName="dlgFooter">
	</mx:ControlBar>
		
</GenModalDialog>
