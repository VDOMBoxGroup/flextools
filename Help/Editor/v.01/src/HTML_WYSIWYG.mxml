<?xml version="1.0" encoding="utf-8"?>
<mx:HTML xmlns:mx="http://www.adobe.com/2006/mxml" 
	location="libs/ckeditor/_samples/fullpage.html"
	creationComplete="init()" width="100%" height="100%"
	htmlDOMInitialize="html1_htmlDOMInitializeHandler(event)">
	<mx:Script>
		<![CDATA[
			private var instancesInitialized : Boolean;
			
			private function init():void
			{
			}
			
			public function setHTML( value : String ) : void
			{
				if (!instancesInitialized) {
					return;
				}
				domWindow.CKEDITOR.instances.editor1.setData(value);
			}
			
			private function getBodyContent(value : String) : String
			{
				var patternBodyOpen		: RegExp;
				var patternBodyClose	: RegExp;
				
				patternBodyOpen = /<[ ]*body[ ]*>/i;
				patternBodyClose = /<[ ]*\/[ ]*body[ ]*>/i;
				
				
				var arrMatchOpen:Array = value.match(patternBodyOpen);
				if (arrMatchOpen.length > 0) {
					value = value.substr(arrMatchOpen.index + arrMatchOpen[0].length);
				}
				
				var arrMatchClose:Array = value.match(patternBodyClose);
				if (arrMatchClose.length > 0) {
					value = value.substring(0, arrMatchClose.index);
				}
				
				return value;
			}
			
			public function getHTML(  ) : String
			{
				var editorData	: String;
				var patternHead	: RegExp;
				var metaTeg		: String;
				var cssTeg		: String;
				var htmlTxt		: String;
				
				metaTeg = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />";
				cssTeg = "<link rel='stylesheet' href='app-storage:/main.css' type='text/css'></link>";
				patternHead = /<[ ]*head[ ]*(>|\/[ ]*>)/i;
				
				editorData = instancesInitialized ? domWindow.CKEDITOR.instances.editor1.getData() : "";
				htmlTxt = editorData;
				
				if (editorData.search(patternHead) == -1) 
				{
					htmlTxt =  
						"<html>" + "\n" + 
							"<head>" + "\n" +
								metaTeg + "\n" +
								cssTeg + "\n" +
							"</head>" + "\n" +
							"<body>" + "\n" +
								editorData + "\n" +
							"</body>" + "\n" +
						"<html>"
				}
				
				return htmlTxt;
			}
			
			
			private function zzzzzz( ddd : *, aaa : *, sss : *  ) : void
			{
				//dispatchEvent( new Event("onSave") );
			}
		
			
			protected function html1_htmlDOMInitializeHandler(event:Event):void
			{
				// TODO Auto-generated method stub
				instancesInitialized = true;
			}
			
		]]>
	</mx:Script>
</mx:HTML>
