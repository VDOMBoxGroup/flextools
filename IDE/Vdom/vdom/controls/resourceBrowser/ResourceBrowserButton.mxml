<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:mx="http://www.adobe.com/2006/mxml" height="20" width="100" horizontalAlign="right" initialize="initalizeHandler();" verticalAlign="middle">
	<mx:Script>
	
		<![CDATA[
			import mx.core.Application;
			import mx.managers.PopUpManager;
			import vdom.events.ResourceBrowserEvent;
			
			private var _value:String = "";
			private var _title:String = "";
			private var _rBrowserInstance:ResourceBrowser;
	
			private function initalizeHandler():void {
			}
	
			public function set title(attrValue:String):void {
				_title = attrValue;
			} 
			
			[Bindable]
			public function get value():String {
				return _value;
			}
	
			public function set value(attrValue:String):void {
				_value = attrValue;
			}
	
			private function openWindow():void {
				_rBrowserInstance = ResourceBrowser(PopUpManager.createPopUp(DisplayObject(Application.application), ResourceBrowser, true));
				PopUpManager.centerPopUp(_rBrowserInstance);
				_rBrowserInstance.addEventListener(ResourceBrowserEvent.RESOURCE_SELECTED, completeHandler);
				
				var resRegExp:RegExp = /^#Res\(([-a-zA-Z0-9]*)\)/;
				if (_value.match(resRegExp) != null) {
					_rBrowserInstance.selectedItemID = _value.match(resRegExp)[1];
					trace("Resource browser: selected resource id is " + _rBrowserInstance.selectedItemID);
				}
			}
	
			private function completeHandler(event:ResourceBrowserEvent):void {
				_value = "#Res(" + event.resourceID + ")";
				lbl.text = event.resourceName;
				trace("Resource browser: now selected resource id is " + _value);
			}
	
		]]>
	</mx:Script>

	<mx:Label text="{value}" id="lbl" width="70"/>
	<mx:Button label="..." height="20" cornerRadius="0" click="openWindow()" width="22" paddingLeft="2" paddingRight="2"/>
</mx:HBox>
