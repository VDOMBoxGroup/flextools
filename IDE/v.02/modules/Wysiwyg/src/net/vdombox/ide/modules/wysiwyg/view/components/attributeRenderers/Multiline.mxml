<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:mx="http://www.adobe.com/2006/mxml"
		 
		 height="20" width="100%"
		 borderColor="#FFFFFF" borderStyle="solid" horizontalAlign="right" verticalAlign="middle">

	<mx:Script>
		<![CDATA[
			import mx.core.UIComponent;
			import mx.events.FlexEvent;
			import mx.events.ValidationResultEvent;
			import mx.managers.PopUpManager;
			
			import net.vdombox.ide.modules.wysiwyg.events.AttributeEvent;
			import net.vdombox.ide.modules.wysiwyg.events.MultilineWindowEvent;
			import net.vdombox.ide.modules.wysiwyg.view.components.windows.MultilineWindow;
			import net.vdombox.utils.WindowManager;

			private var _value : String;
			private var _title : String = "Multiline Window";
			public var multilineWindow : MultilineWindow;
			
			public function set title( attrValue : String ) : void
			{
				_title = attrValue;
			}

			[Bindable]
			public function get value() : String
			{
				return _value;
			}

			public function set value( value : String ) : void
			{
				_value = value;
			}
			
			private function openWindow() : void
			{				
//				var popUpWindowManager : PopUpManager = PopUpManager.getInstance();
				multilineWindow = new MultilineWindow();

				multilineWindow.attributeValue = _value;
				multilineWindow.title = resourceManager.getString( 'Wysiwyg_General', 'multiline_window_title' );
				dispatchEvent( new AttributeEvent( AttributeEvent.CHOSE_RESOURCES_IN_MULTILINE ) );				
				
				multilineWindow.addEventListener( MultilineWindowEvent.APPLY, multilineWindow_applyHandler, false, 0, true );
				multilineWindow.addEventListener( MultilineWindowEvent.CLOSE, multilineWindow_applyHandler, false, 0, true );
				
				//PopUpManager.addPopUp( multilineWindow, DisplayObject( UIComponent( parent ).parentApplication ), true );
				//PopUpManager.centerPopUp( multilineWindow );
				WindowManager.getInstance().addWindow(multilineWindow, UIComponent( UIComponent(parent).parentApplication ), true);
			}

			private function multilineWindow_applyHandler( event : MultilineWindowEvent ) : void
			{				
				var currentTarget : Object = event.currentTarget;

				if ( currentTarget is MultilineWindow )
				{
					if (event.type == MultilineWindowEvent.APPLY)
						value = event.value;				
					UIComponent( currentTarget ).removeEventListener( MultilineWindowEvent.APPLY, multilineWindow_applyHandler, false );					
				}

				//PopUpManager.removePopUp( multilineWindow );
				WindowManager.getInstance().removeWindow(multilineWindow);
			}


			override public function validationResultHandler( event : ValidationResultEvent ) : void
			{
				super.validationResultHandler( event );
				if ( event.type == "valid" )
					setStyle( "borderColor", "white" );
				else if ( event.type == "ivalid" )
					setStyle( "borderColor", "red" );
			}
		]]>
	</mx:Script>

	<mx:Label id="lbl"
			  text="Multiline" />

	<mx:Button height="19" label="..." width="22"
			   cornerRadius="0" paddingLeft="2" paddingRight="2"
			   click="openWindow()" />
</mx:HBox>
